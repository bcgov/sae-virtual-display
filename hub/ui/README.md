# SAE UI

The SAE UI is an enhanced abstraction layer over JupyterHub's server management interface. It allows for more advanced control over how servers are spawned and sorted. Atlaskit is the UI library.

## Installation

### Prerequisites

- Node 12 or newer
- Docker 18.09.1 or newer

### Bare Metal Install

Run `$ npm install` to install dependencies.

### Production

This application uses Webpack for compilation. Building for production generates a minified `bundle.js` which should be moved to JupyterHub's `js` asset folder. Reference `templates/index.html` for the other CSS and JavaScript assets required.

### Developing

 `$ npm start` to run the development version of the server. 

#### Configuration Options

React Context is used to access configuration options. To start the application in the browser run the following after the JavaScript file has been added at the bottom of the `<body>` tag.

```javascript
     (function(config) {
       workbench.default(config); // <- workbench is the namespace
     })({
     ...configOptions
     });
```

Below are the configuration options required

| Property       | Default    | Type                                       | Value                                                           |
|----------------|------------|--------------------------------------------|-----------------------------------------------------------------|
| `announcement` | `''`       | `String`                                   | Any JupyterHub announcement can be pass through here            |
| `appName`      | `''`       | `String`                                   | The app's namespace for requesting help or analytics if enabled |
| `baseURL`      | `''`       | `String`                                   | The base URL of the API server                                  |
| `staticURL`    | `'/'`      | `String`                                   | URL of all assets like CSS or images                            |
| `help`         | -          | `Object` |     Help configuration                         |                                                                 |
| `help.url`         | -          | `String` |     The URL of the UserGuide Bridge which is accessed for help content.                         |                                                                 |
| `help.onboarding`         | `'onboarding'`          | `String` |   The name of the onboarding content identifier                         |                                                                 |
| `help.main`         | `'documentation'`          | `String` | The name of the main documentation (a dialog accessed through the appbar menu) identifier |
| `imagesDir`    | `'images'` | `String` | The directory of images inside `staticURL` |                                                                 |
| `user`         | `''`       | `String` | The username, used in API requests         |                                                                 |
| `apps`         | `[]`       | `Array<App>` | The list of applications available to build in the main interface (see definition below) |                                                                 |
| `projects`     | `[]`       | `Array<String>` | The directory of images inside `staticURL` |                                                                 |
| `DEV`          | `true`     | `Boolean` |Turn on development only feature flag      |                                                                 |

An `App` (referenced above) has the following properties on it:
```javascript
{
  "name": "app-slug", // The slug of the app (used as an identifier in most cases)
  "logo": "app_logo_name",  // The name of the logo file (not used, generated by JH)
  "label": "App Name", // Name of the app
  "container": "container_url", // Container URL, viewed by clicking More Info
  "image": "/images/logo.png" // The path to the logo file
}
```
### Help Content

##### 1. Onboarding

Assuming that the User Guide API microservice is formatted correctly, the request for `help.onboarding` will return an array of objects, each of which will contain a `title` property, which should have a value somewhat like a slug, i.e. `app-card`. Using the [Onboarding](https://atlaskit.atlassian.com/packages/core/onboarding) any `SpotlightTarget` in any component with a matching target value will render the `body` content from that object.

```javascript
// Onboarding API Response
[
  {
    title: 'app-card',
    body: 'lorem ipsum ...'
  },
  {
    title: 'filter-list',
    body: 'lorem dolor'
  }
]
// Component
<SpotlightTarget name="app-card">
  <AppCard {...props} />
</SpotlightTarget>
```
| Target | Component Location & Description |
|--------| ---------------------------------|
| `app-card` | Surrounds the first application in the list view |
| `filter-apps` | The search filter input in the top left |
| `toggle-apps` | The toggle visible apps button in the top right |

Help main will return the same payload as above, but the sections will be rendered in a dialog, so no special steps are required to make sure the `title` aligns with any components.


### Testing

Run '$ npm test' to run tests with coverage, `$ npm run test:watch` to run tests in watch mode.

### Storybook

Storybook is employed to view and test components. Run `$ npm run storybook` to launch the Storybook server and `$ npm run build-storybook` to build the components.

## Developer Guidelines

This project uses Eslint for linting, Prettier for code formatting and Jest for testing. It is recommended for continuity and to lighten the number of lines of code added to a Git commit that these plugins are enabled in your IDE of choice.

